(function(){"use strict";try{var t,n,r,i=function(t){t=t.trim();var n=t.length;return n<140&&n>0?!0:!1};chrome.omnibox.onInputEntered.addListener(function(r){if(i(r)){t=r;n&&o(t,n,"tweetEntered");console.log("tweet:"+r)}});var s="Tweet: %s";chrome.omnibox.setDefaultSuggestion({description:s});chrome.omnibox.onInputStarted.addListener(function(){var r=new XMLHttpRequest;r.open("GET","https://twitter.com",!0);r.onreadystatechange=function(){var i,s=r.responseText;s&&(i=s.indexOf('name="authenticity_token"'));if(s&&i>-1){i=s.substring(0,i);var u=i.lastIndexOf('value="')+7,a=i.lastIndexOf('"');n=i.substring(u,a);console.log("authToken:"+n);t&&o(t,n,"xhr");r.abort()}};r.send()});chrome.omnibox.onInputChanged.addListener(function(t,n){t.length>100?chrome.omnibox.setDefaultSuggestion({description:"Tweet ("+t.length+"): %s"}):chrome.omnibox.setDefaultSuggestion({description:s})});var o=function(t,n){r=new XMLHttpRequest;r.open("POST","https://twitter.com/i/tweet/create",!0);r.onreadystatechange=function(){if(r.readyState===4){alert("Posted tweet");r.abort();r=undefined}};r.setRequestHeader("Content-type","application/x-www-form-urlencoded");r.send("status="+t+"&place_id=&authenticity_token="+n);t=!1};chrome.omnibox.onInputCancelled.addListener(function(){t=!1;r&&r.abort()});console.log("loaded")}catch(u){console.error("lastError:"+(chrome.runtime.lastError?chrome.runtime.lastError.message:""));console.error("lastError object:",chrome.runtime.lastError);throw u}})();