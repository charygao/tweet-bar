(function(){var t=function(t,n,r,i){var s=new XMLHttpRequest;s.open(r,t,!0);s.onreadystatechange=function(){s.readyState===4&&n(s.responseText,s)};r==="POST"&&s.setRequestHeader("Content-type","application/x-www-form-urlencoded");s.send(i)};POST=function(n,r,i){t(n,r,"POST",i)}})();(function(){"use strict";try{var t,n,r=function(t){t=t.trim();var n=t.length;return n<140&&n>0?!0:!1};chrome.omnibox.onInputEntered.addListener(function(i){if(r(i)){t=i;n&&s(t,n,"tweetEntered");console.log("tweet")}});var i="Tweet: %s";chrome.omnibox.setDefaultSuggestion({description:i});chrome.omnibox.onInputStarted.addListener(function(){var r=new XMLHttpRequest;r.open("GET","https://twitter.com",!0);r.onreadystatechange=function(){var i,o=r.responseText;o&&(i=o.indexOf('name="authenticity_token"'));if(o&&i>-1){i=o.substring(0,i);var u=i.lastIndexOf('value="')+7,a=i.lastIndexOf('"');n=i.substring(u,a);console.log("authToken:"+n);t&&s(t,n,"xhr");r.abort()}};r.send();console.log(r);console.dir(r)});chrome.omnibox.onInputChanged.addListener(function(t,n){t.length>100?chrome.omnibox.setDefaultSuggestion({description:"Tweet ("+t.length+"): %s"}):chrome.omnibox.setDefaultSuggestion({description:i})});var s=function(t,n){console.log("postTweet:",arguments);POST("https://twitter.com/i/tweet/create",function(){console.log("post resp",arguments)},"status="+t+"&place_id=&authenticity_token="+n);t=!1;alert("Posted tweet")};console.log("loaded")}catch(o){console.error("lastError:"+(chrome.runtime.lastError?chrome.runtime.lastError.message:""));console.error("lastError object:",chrome.runtime.lastError);throw o}})();